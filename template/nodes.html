{{template "header" .Meta}}
<div class="container mx-auto py-4">
    {{if .Reports}}
        <table class="table-auto">
            <caption hidden>List of Reports</caption>
            <thead>
            <tr>
                <th class="px-1 py-1" scope="col">ID</th>
                <th class="px-1 py-1" scope="col">Custom ID</th>
                <th class="px-1 py-1" scope="col">Hostname</th>
                <th class="px-1 py-1" scope="col">Received Time</th>
                <th class="px-1 py-1" scope="col">Connected Server</th>
                <th class="px-1 py-1" scope="col">Global IP</th>
                <th class="px-1 py-1" scope="col">Local IP</th>
                <th class="px-1 py-1" scope="col">Seq</th>
                <th class="px-1 py-1" scope="col">Version</th>
                <th class="px-1 py-1" scope="col">Result</th>
            </tr>
            </thead>
            <tbody>
            {{range .Reports}}
                {{$alive := t_fresh .ServerTime 5}}
                <tr{{if not $alive}} class="text-gray-600"{{end}}>
                    <td class="border px-1 py-1">
                        <a href="/nodes/{{.ID}}" class="underline">{{.ID}}</a>
                    </td>
                    <td class="border px-1 py-1">{{.CustomID}}</td>
                    <td class="border px-1 py-1">{{.Hostname}}</td>
                    <td class="border px-1 py-1 {{if $alive}}text-green-700{{else}}text-gray-600{{end}}">
                        {{t_fmt .ServerTime "2006/1/2 15:04:05"}}
                    </td>
                    <td class="border px-1 py-1">
                        {{if .SSHRemotePort}}{{.SSHServerHost}}:{{.SSHRemotePort}}{{else}}N/A{{end}}
                    </td>
                    <td class="border px-1 py-1" title="{{if .GlobalHost}}{{.GlobalHost}}{{else}}{{.GlobalIP}}{{end}}">
                        {{.GlobalIP}}
                    </td>
                    <td class="border px-1 py-1">{{.LocalIPv4}}</td>
                    <td class="border px-1 py-1">{{.Sequence}}</td>
                    <td class="border px-1 py-1">{{.AgentVersion}}</td>
                    <td class="border px-1 py-1">
                        {{if .Errors}}
                            <span class="text-red-600">
                            {{if eq (len .Errors) 1}}1 error{{else}}{{len .Errors}} errors{{end}}
                        </span>
                        {{else}}
                            <span class="{{if $alive}}text-green-700{{end}}">OK</span>
                        {{end}}
                    </td>
                </tr>
            {{end}}
            </tbody>
        </table>
        <div>Showing {{.Pager.Head}} to {{.Pager.Tail}}, Total {{.Pager.Total}}</div>
        <div class="text-center py-1">
            <div class="inline-flex">
                {{if eq .Pager.Current 1}}
                    <button disabled
                            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-l shadow opacity-50 cursor-not-allowed">
                        &lt; Prev
                    </button>
                {{else}}
                    <form method="get" action="" class="inline-block">
                        {{range $k, $vs := .Pager.Queries}}
                            {{if ne $k "page"}}
                                {{range $vs}}
                                    <input type="hidden" name="{{$k}}" value="{{.}}"/>
                                {{end}}
                            {{end}}
                        {{end}}
                        <input type="hidden" name="page" value="{{.Pager.Prev}}"/>
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-l shadow">
                            &lt; Prev
                        </button>
                    </form>
                {{end}}
                {{if eq .Pager.Total .Pager.Tail}}
                    <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-r shadow opacity-50 cursor-not-allowed"
                            disabled>
                        Next &gt;
                    </button>
                {{else}}
                    <form method="get" action="" class="inline-block">
                        {{range $k, $vs := .Pager.Queries}}
                            {{if ne $k "page"}}
                                {{range $vs}}
                                    <input type="hidden" name="{{$k}}" value="{{.}}"/>
                                {{end}}
                            {{end}}
                        {{end}}
                        <input type="hidden" name="page" value="{{.Pager.Next}}"/>
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-r shadow">
                            Next &gt;
                        </button>
                    </form>
                {{end}}
            </div>
        </div>
    {{else}}
        <p>WARNING: No reports found.</p>
    {{end}}
</div>
{{template "footer" .Meta}}
